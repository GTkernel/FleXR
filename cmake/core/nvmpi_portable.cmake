macro(core_use_nvmpi_portable)
  if(${USE_NVMPI_PORTABLE})
    pkg_search_module(NVMPI_PORTABLE REQUIRED nvmpi_portable)
    if(NVMPI_PORTABLE_FOUND)
      pkg_search_module(NVMPI REQUIRED nvmpi)
      if(NVMPI_FOUND)
        message(STATUS "NVMPI_PORTABLE Details")
        message("\t NVMPI_INCLUDE_DIRS: ${NVMPI_INCLUDE_DIRS}")
        message("\t NVMPI_LDFLAGS: ${NVMPI_LDFLAGS}")
        message("\t NVMPI_PORTABLE_INCLUDE_DIRS: ${NVMPI_PORTABLE_INCLUDE_DIRS}")
        message("\t NVMPI_PORTABLE_LDFLAGS: ${NVMPI_PORTABLE_LDFLAGS}")

        include_directories(${NVMPI_INCLUDE_DIRS})
        list(APPEND FLEXR_CORE_CXX_FLAGS ${NVMPI_CXX_FLAGS})
        list(APPEND FLEXR_CORE_INCLUDE_DIRS -I${NVMPI_INCLUDE_DIRS})
        list(APPEND FLEXR_CORE_LINKER_FLAGS ${NVMPI_LDFLAGS})

        include_directories(${NVMPI_PORTABLE_INCLUDE_DIRS})
        list(APPEND FLEXR_CORE_CXX_FLAGS ${NVMPI_PORTABLE_CXX_FLAGS})
        list(APPEND FLEXR_CORE_INCLUDE_DIRS -I${NVMPI_PORTABLE_INCLUDE_DIRS})
        list(APPEND FLEXR_CORE_LINKER_FLAGS ${NVMPI_PORTABLE_LDFLAGS})
      endif(NVMPI_FOUND)
    endif(NVMPI_PORTABLE_FOUND)
  endif(${USE_NVMPI_PORTABLE})
endmacro()

